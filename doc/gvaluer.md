Навигация: [Главная страница](main_Page.md)/[Система
ejudge](система_ejudge.md)/[Использование](использование.md)/[Оценивающие
программы](оценивающие_программы.md)/[gvaluer](gvaluer.md)

### Компиляция

Программа находится в каталоге `checkers` исходных текстов ejudge. Для
компиляции необходим компилятор C++ с поддержкой C++11 (например, g++
4.7 и выше).

`g++ -O2 -Wall -std=gnu++11 gvaluer.cpp -ogvaluer`

Откомпилированную программу можно поместить либо в каталог задачи, либо
в каталог `problems` турнира (то есть родительский каталог относительно
каталога задачи).

С версии [3.13.0](изменения_в_версии_3.13.0.md) и выше нет
необходимости компилировать программу самостоятельно, она инсталлируется
в каталог проверяющих программ.

### Настройка [serve.cfg](serve.cfg.md)

Если программа gvaluer помещена в каталог `problems`, то раздел
определения задачи должен содержать следующую строку

[`valuer_cmd`](serve.cfg/problem/valuer_cmd.md)` = "../gvaluer"`

С версии [3.13.0](изменения_в_версии_3.13.0.md) и выше
рекомендуется использовать стандартную программу.

[`standard_valuer`](serve.cfg/problem/standard_valuer.md)` = "gvaluer"`

В каталоге задачи необходимо создать файл `valuer.cfg`, в котором
описывается структура групп тестов.

### Файл valuer.cfg

Файл описывает структуру групп тестов. Файл имеет свободный формат, то
есть элементы описания могут быть разделены произвольным количеством
пробельных символов. Символ \# используется для обозначения начала
комментария. Символы, начиная от \# и до конца текущей строки
игнорируются. Синтаксис файла описывается следующей грамматикой:

`file : [ global_definition ] { group_definition } EOF ;`  
`global_definition : "global" "{" { global_option } "}" ;  /* определяет настройки для всех групп тестов (с `[`3.6.1`](изменения_в_версии_3.6.1.md)`) */`  
`global_option :`  
`    "stat_to_users"                                       /* выводить информацию о прохождении всех групп для участников турнира */`  
`  | "stat_to_judges"                                      /* выводить информацию о прохождении всех групп для привилегированных пользователей */`  
`  ;`  
`group_definition : "group" GROUP_ID "{" { group_option } "}" ;`  
`group_option :`  
`    "tests" FIRST_TEST_NUM "-" LAST_TEST_NUM ";"          /* определяет диапазон номеров тестов в этой группе */`  
`  | "score" SCORE ";"                                     /* определяет балл за группу тестов */`  
`  | "test_score" SCORE ";"                                /* определяет балл за один тест */`  
`  | "requires" GROUP_ID { "," GROUP_ID } ";"              /* перечисляет группы тестов, от которых зависит данная группа тестов */`  
`  | "offline" ";"                                         /* тесты с off-line проверкой */`  
`  | "sets_marked" ";"                                     /* установить флаг marked, если группа прошла (с `[`2.3.27`](изменения_в_версии_2.3.27.md)`) */`  
`  | "skip" ";"                                            /* безусловно пропустить данную группу тестов (с `[`2.3.27`](изменения_в_версии_2.3.27.md)`) */`  
`  | "sets_marked_if_passed" GROUP_ID { "," GROUP_ID } ";" /* установить флаг marked, если прошли указанные группы тестов (с `[`2.3.28`](изменения_в_версии_2.3.28.md)`) */`  
`  | "pass_if_count" NUM ";"                               /* считать группу тестов прошедшей, если в ней прошло NUM тестов (с `[`2.3.28`](изменения_в_версии_2.3.28.md)`) */`  
`  | "skip_if_not_rejudge" ";"                             /* пропустить группу тестов, если это не повторное тестирование посылки (REJUDGE) (с `[`3.0`](изменения_в_версии_3.0.md)`) */`  
`  | "stat_to_judges" ";"                                  /* вывести статистику о прохождении данной группы в файл комментариев для судей (с `[`3.3.0`](изменения_в_версии_3.3.0.md)`) */`  
`  | "stat_to_users" ";"                                   /* вывести статистику о прохождении данной группы в файл комментариев для участников турнира (с `[`3.6.1`](изменения_в_версии_3.6.1.md)`) */`  
`  | "user_status" STATUS ";"                              /* установить пользовательский статус тестирования в указанный, если прошла данная группа тестов (с `[`3.3.0`](изменения_в_версии_3.3.0.md)`) */`  
`  | "test_all" ";"                                        /* тестировать на всех тестах даже группы с групповой оценкой (с `[`3.3.0`](изменения_в_версии_3.3.0.md)`) */`  
`  | "0_if" TEST { "," TEST } ";"                          /* оценить группу в 0 баллов, если прошли только указанные тесты (с `[`3.6.0`](изменения_в_версии_3.6.0.md)`) */`  
`  | "0_if_subset" TEST { "," TEST } ";"                   /* оценить группу в 0 баллов, если прошли только тесты из указанного множества тестов (с `[`3.10.2`](изменения_в_версии_3.10.2.md)`) */`  
`  ;`

Пример файла приведен далее

`group 0 {`  
`    tests 1-2;`  
`    score 0;`  
`    test_score 0;`  
`}`  
  
`group 1 {`  
`    tests 3-18;`  
`    score 20;`  
`}`  
  
`group 2 {`  
`    tests 19-26;`  
`    score 20;`  
`}`  
  
`group 3 {`  
`    tests 27-42;`  
`    score 60;`  
`    requires 1,2;`  
`    offline;`  
`}`

### Переменные окружения

| Имя                  | значение       | описание                                                                                      |
|----------------------|----------------|-----------------------------------------------------------------------------------------------|
| `EJUDGE`             | любое значение | должна быть установлена                                                                       |
| `EJUDGE_INTERACTIVE` | любое значение | если установлена, см. [`interactive_valuer`](serve.cfg/problem/interactive_valuer.md) |
| `EJUDGE_REJUDGE`     | любое значение | если установлена, то посылка перепроверяется                                                  |
| `EJUDGE_USER_SCORE`  | любое значение | если установлена, см [`separate_user_score`](serve.cfg/global/separate_user_score.md) |
| `EJUDGE_MARKED`      | любое значение | если установлена, см. [`valuer_sets_marked`](serve.cfg/problem/valuer_sets_marked.md) |
| `EJUDGE_GROUP_MERGE` | любое значение | если установлена, см. [`enable_group_merge`](serve.cfg/problem/enable_group_merge.md) |
| `EJUDGE_LOCALE`      | ID языка (int) | если установлена, см. [`checker_locale`](serve.cfg/global/checker_locale.md)          |

Переменные окружения
